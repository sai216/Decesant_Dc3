"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_node_modules_reown_appkit-controllers_dist_esm_exports_features_js"],{

/***/ "(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/exports/features.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@reown/appkit-controllers/dist/esm/exports/features.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ReownAuthentication: () => (/* reexport safe */ _src_features_reown_authentication_index_js__WEBPACK_IMPORTED_MODULE_0__.ReownAuthentication),\n/* harmony export */   ReownAuthenticationMessenger: () => (/* reexport safe */ _src_features_reown_authentication_index_js__WEBPACK_IMPORTED_MODULE_0__.ReownAuthenticationMessenger)\n/* harmony export */ });\n/* harmony import */ var _src_features_reown_authentication_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../src/features/reown-authentication/index.js */ \"(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/index.js\");\n\n//# sourceMappingURL=features.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AcmVvd24vYXBwa2l0LWNvbnRyb2xsZXJzL2Rpc3QvZXNtL2V4cG9ydHMvZmVhdHVyZXMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQThEO0FBQzlEIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHRpcnVtXFxEb3dubG9hZHNcXERlY2Vuc2F0X2RjM1xcbm9kZV9tb2R1bGVzXFxAcmVvd25cXGFwcGtpdC1jb250cm9sbGVyc1xcZGlzdFxcZXNtXFxleHBvcnRzXFxmZWF0dXJlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgKiBmcm9tICcuLi9zcmMvZmVhdHVyZXMvcmVvd24tYXV0aGVudGljYXRpb24vaW5kZXguanMnO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmVhdHVyZXMuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/exports/features.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/ReownAuthentication.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/ReownAuthentication.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ReownAuthentication: () => (/* binding */ ReownAuthentication)\n/* harmony export */ });\n/* harmony import */ var _reown_appkit_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @reown/appkit-common */ \"(app-pages-browser)/./node_modules/@reown/appkit-common/dist/esm/src/utils/SafeLocalStorage.js\");\n/* harmony import */ var _reown_appkit_common__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @reown/appkit-common */ \"(app-pages-browser)/./node_modules/@reown/appkit-common/dist/esm/src/utils/ConstantsUtil.js\");\n/* harmony import */ var _controllers_ApiController_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../controllers/ApiController.js */ \"(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/controllers/ApiController.js\");\n/* harmony import */ var _controllers_BlockchainApiController_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../controllers/BlockchainApiController.js */ \"(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/controllers/BlockchainApiController.js\");\n/* harmony import */ var _controllers_ChainController_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../controllers/ChainController.js */ \"(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/controllers/ChainController.js\");\n/* harmony import */ var _utils_ChainControllerUtil_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/ChainControllerUtil.js */ \"(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/utils/ChainControllerUtil.js\");\n/* harmony import */ var _ReownAuthenticationMessenger_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ReownAuthenticationMessenger.js */ \"(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/ReownAuthenticationMessenger.js\");\n//\n\n\n\n\n\n\n/**\n * This is the configuration for using SIWX with Reown Authentication service.\n * It allows you to authenticate and capture user sessions through the Cloud Dashboard.\n */\nclass ReownAuthentication {\n    constructor(params = {}) {\n        this.otpUuid = null;\n        this.listeners = {\n            sessionChanged: []\n        };\n        this.localAuthStorageKey =\n            params.localAuthStorageKey ||\n                _reown_appkit_common__WEBPACK_IMPORTED_MODULE_0__.SafeLocalStorageKeys.SIWX_AUTH_TOKEN;\n        this.localNonceStorageKey =\n            params.localNonceStorageKey ||\n                _reown_appkit_common__WEBPACK_IMPORTED_MODULE_0__.SafeLocalStorageKeys.SIWX_NONCE_TOKEN;\n        this.required = params.required ?? true;\n        this.messenger = new _ReownAuthenticationMessenger_js__WEBPACK_IMPORTED_MODULE_1__.ReownAuthenticationMessenger({\n            getNonce: this.getNonce.bind(this)\n        });\n    }\n    async createMessage(input) {\n        return this.messenger.createMessage(input);\n    }\n    async addSession(session) {\n        const response = await this.request({\n            method: 'POST',\n            key: 'authenticate',\n            body: {\n                data: session.data,\n                message: session.message,\n                signature: session.signature,\n                clientId: this.getClientId(),\n                walletInfo: this.getWalletInfo()\n            },\n            headers: ['nonce', 'otp']\n        });\n        this.setStorageToken(response.token, this.localAuthStorageKey);\n        this.emit('sessionChanged', session);\n        this.setAppKitAccountUser(jwtDecode(response.token));\n        this.otpUuid = null;\n    }\n    async getSessions(chainId, address) {\n        try {\n            if (!this.getStorageToken(this.localAuthStorageKey)) {\n                return [];\n            }\n            const account = await this.request({\n                method: 'GET',\n                key: 'me',\n                query: {},\n                headers: ['auth']\n            });\n            if (!account) {\n                return [];\n            }\n            const isSameAddress = account.address.toLowerCase() === address.toLowerCase();\n            const isSameNetwork = account.caip2Network === chainId;\n            if (!isSameAddress || !isSameNetwork) {\n                return [];\n            }\n            const session = {\n                data: {\n                    accountAddress: account.address,\n                    chainId: account.caip2Network\n                },\n                message: '',\n                signature: ''\n            };\n            this.emit('sessionChanged', session);\n            this.setAppKitAccountUser(account);\n            return [session];\n        }\n        catch {\n            return [];\n        }\n    }\n    async revokeSession(_chainId, _address) {\n        return Promise.resolve(this.clearStorageTokens());\n    }\n    async setSessions(sessions) {\n        if (sessions.length === 0) {\n            this.clearStorageTokens();\n        }\n        else {\n            const session = (sessions.find(s => s.data.chainId === (0,_utils_ChainControllerUtil_js__WEBPACK_IMPORTED_MODULE_2__.getActiveCaipNetwork)()?.caipNetworkId) || sessions[0]);\n            await this.addSession(session);\n        }\n    }\n    getRequired() {\n        return this.required;\n    }\n    async getSessionAccount() {\n        if (!this.getStorageToken(this.localAuthStorageKey)) {\n            throw new Error('Not authenticated');\n        }\n        return this.request({\n            method: 'GET',\n            key: 'me',\n            body: undefined,\n            query: {\n                includeAppKitAccount: true\n            },\n            headers: ['auth']\n        });\n    }\n    async setSessionAccountMetadata(metadata = null) {\n        if (!this.getStorageToken(this.localAuthStorageKey)) {\n            throw new Error('Not authenticated');\n        }\n        return this.request({\n            method: 'PUT',\n            key: 'account-metadata',\n            body: { metadata },\n            headers: ['auth']\n        });\n    }\n    on(event, callback) {\n        this.listeners[event].push(callback);\n        return () => {\n            this.listeners[event] = this.listeners[event].filter(cb => cb !== callback);\n        };\n    }\n    removeAllListeners() {\n        const keys = Object.keys(this.listeners);\n        keys.forEach(key => {\n            this.listeners[key] = [];\n        });\n    }\n    async requestEmailOtp({ email, account }) {\n        const otp = await this.request({\n            method: 'POST',\n            key: 'otp',\n            body: { email, account }\n        });\n        this.otpUuid = otp.uuid;\n        this.messenger.resources = [`email:${email}`];\n        return otp;\n    }\n    confirmEmailOtp({ code }) {\n        return this.request({\n            method: 'PUT',\n            key: 'otp',\n            body: { code },\n            headers: ['otp']\n        });\n    }\n    async request({ method, key, query, body, headers }) {\n        const { projectId, st, sv } = this.getSDKProperties();\n        const url = new URL(`${_reown_appkit_common__WEBPACK_IMPORTED_MODULE_3__.ConstantsUtil.W3M_API_URL}/auth/v1/${String(key)}`);\n        url.searchParams.set('projectId', projectId);\n        url.searchParams.set('st', st);\n        url.searchParams.set('sv', sv);\n        if (query) {\n            Object.entries(query).forEach(([queryKey, queryValue]) => url.searchParams.set(queryKey, String(queryValue)));\n        }\n        const response = await fetch(url, {\n            method,\n            body: body ? JSON.stringify(body) : undefined,\n            headers: Array.isArray(headers)\n                ? headers.reduce((acc, header) => {\n                    switch (header) {\n                        case 'nonce':\n                            acc['x-nonce-jwt'] = `Bearer ${this.getStorageToken(this.localNonceStorageKey)}`;\n                            break;\n                        case 'auth':\n                            acc['Authorization'] = `Bearer ${this.getStorageToken(this.localAuthStorageKey)}`;\n                            break;\n                        case 'otp':\n                            if (this.otpUuid) {\n                                acc['x-otp'] = this.otpUuid;\n                            }\n                            break;\n                        default:\n                            break;\n                    }\n                    return acc;\n                }, {})\n                : undefined\n        });\n        if (!response.ok) {\n            throw new Error(await response.text());\n        }\n        if (response.headers.get('content-type')?.includes('application/json')) {\n            return response.json();\n        }\n        return null;\n    }\n    getStorageToken(key) {\n        return _reown_appkit_common__WEBPACK_IMPORTED_MODULE_0__.SafeLocalStorage.getItem(key);\n    }\n    setStorageToken(token, key) {\n        _reown_appkit_common__WEBPACK_IMPORTED_MODULE_0__.SafeLocalStorage.setItem(key, token);\n    }\n    clearStorageTokens() {\n        this.otpUuid = null;\n        _reown_appkit_common__WEBPACK_IMPORTED_MODULE_0__.SafeLocalStorage.removeItem(this.localAuthStorageKey);\n        _reown_appkit_common__WEBPACK_IMPORTED_MODULE_0__.SafeLocalStorage.removeItem(this.localNonceStorageKey);\n        this.emit('sessionChanged', undefined);\n    }\n    async getNonce() {\n        const { nonce, token } = await this.request({\n            method: 'GET',\n            key: 'nonce'\n        });\n        this.setStorageToken(token, this.localNonceStorageKey);\n        return nonce;\n    }\n    getClientId() {\n        return _controllers_BlockchainApiController_js__WEBPACK_IMPORTED_MODULE_4__.BlockchainApiController.state.clientId;\n    }\n    getWalletInfo() {\n        const walletInfo = _controllers_ChainController_js__WEBPACK_IMPORTED_MODULE_5__.ChainController.getAccountData()?.connectedWalletInfo;\n        if (!walletInfo) {\n            return undefined;\n        }\n        if ('social' in walletInfo && 'identifier' in walletInfo) {\n            const social = walletInfo['social'];\n            const identifier = walletInfo['identifier'];\n            return { type: 'social', social, identifier };\n        }\n        const { name, icon } = walletInfo;\n        let type = 'unknown';\n        switch (walletInfo.type) {\n            case 'EXTERNAL':\n            case 'INJECTED':\n            case 'ANNOUNCED':\n                type = 'extension';\n                break;\n            case 'WALLET_CONNECT':\n                type = 'walletconnect';\n                break;\n            default:\n                type = 'unknown';\n        }\n        return {\n            type,\n            name,\n            icon\n        };\n    }\n    getSDKProperties() {\n        return _controllers_ApiController_js__WEBPACK_IMPORTED_MODULE_6__.ApiController._getSdkProperties();\n    }\n    emit(event, data) {\n        this.listeners[event].forEach(listener => listener(data));\n    }\n    setAppKitAccountUser(session) {\n        const { email } = session;\n        if (email) {\n            Object.values(_reown_appkit_common__WEBPACK_IMPORTED_MODULE_3__.ConstantsUtil.CHAIN).forEach(chainNamespace => {\n                _controllers_ChainController_js__WEBPACK_IMPORTED_MODULE_5__.ChainController.setAccountProp('user', { email }, chainNamespace);\n            });\n        }\n    }\n}\n/**\n * Decodes a JWT token and returns its payload\n * @param token - The JWT token to decode\n * @returns The decoded payload or null if invalid\n */\nfunction jwtDecode(token) {\n    // Split the token into parts\n    const parts = token.split('.');\n    // Check if the token has the correct format (header.payload.signature)\n    if (parts.length !== 3) {\n        throw new Error('Invalid token');\n    }\n    // Decode the payload (second part)\n    const payload = parts[1];\n    if (typeof payload !== 'string') {\n        throw new Error('Invalid token');\n    }\n    // Convert base64url to base64\n    const base64 = payload.replace(/-/gu, '+').replace(/_/gu, '/');\n    // Add padding if needed\n    const padded = base64.padEnd(base64.length + ((4 - (base64.length % 4)) % 4), '=');\n    // Decode and parse the JSON\n    const decoded = JSON.parse(atob(padded));\n    return decoded;\n}\n//# sourceMappingURL=ReownAuthentication.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AcmVvd24vYXBwa2l0LWNvbnRyb2xsZXJzL2Rpc3QvZXNtL3NyYy9mZWF0dXJlcy9yZW93bi1hdXRoZW50aWNhdGlvbi9SZW93bkF1dGhlbnRpY2F0aW9uLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7QUFDNkY7QUFDMUI7QUFDb0I7QUFDaEI7QUFDRztBQUNPO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHNFQUFvQjtBQUNwQztBQUNBO0FBQ0EsZ0JBQWdCLHNFQUFvQjtBQUNwQztBQUNBLDZCQUE2QiwwRkFBNEI7QUFDekQ7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtRUFBbUUsbUZBQW9CO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsVUFBVTtBQUM5QjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsNEJBQTRCLGdCQUFnQjtBQUM1QztBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEIsU0FBUztBQUNUO0FBQ0EsNkNBQTZDLE1BQU07QUFDbkQ7QUFDQTtBQUNBLHNCQUFzQixNQUFNO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixNQUFNO0FBQzFCO0FBQ0EsU0FBUztBQUNUO0FBQ0Esb0JBQW9CLG1DQUFtQztBQUN2RCxnQkFBZ0Isb0JBQW9CO0FBQ3BDLCtCQUErQiwrREFBYSxhQUFhLFdBQVcsWUFBWTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxnREFBZ0Q7QUFDM0c7QUFDQTtBQUNBLDZEQUE2RCwrQ0FBK0M7QUFDNUc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsSUFBSTtBQUNyQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGtFQUFnQjtBQUMvQjtBQUNBO0FBQ0EsUUFBUSxrRUFBZ0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0EsUUFBUSxrRUFBZ0I7QUFDeEIsUUFBUSxrRUFBZ0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGVBQWU7QUFDL0I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsNEZBQXVCO0FBQ3RDO0FBQ0E7QUFDQSwyQkFBMkIsNEVBQWU7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsZ0JBQWdCLGFBQWE7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsd0VBQWE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixRQUFRO0FBQ3hCO0FBQ0EsMEJBQTBCLCtEQUFhO0FBQ3ZDLGdCQUFnQiw0RUFBZSwwQkFBMEIsT0FBTztBQUNoRSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFx0aXJ1bVxcRG93bmxvYWRzXFxEZWNlbnNhdF9kYzNcXG5vZGVfbW9kdWxlc1xcQHJlb3duXFxhcHBraXQtY29udHJvbGxlcnNcXGRpc3RcXGVzbVxcc3JjXFxmZWF0dXJlc1xccmVvd24tYXV0aGVudGljYXRpb25cXFJlb3duQXV0aGVudGljYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy9cbmltcG9ydCB7IENvbnN0YW50c1V0aWwsIFNhZmVMb2NhbFN0b3JhZ2UsIFNhZmVMb2NhbFN0b3JhZ2VLZXlzIH0gZnJvbSAnQHJlb3duL2FwcGtpdC1jb21tb24nO1xuaW1wb3J0IHsgQXBpQ29udHJvbGxlciB9IGZyb20gJy4uLy4uL2NvbnRyb2xsZXJzL0FwaUNvbnRyb2xsZXIuanMnO1xuaW1wb3J0IHsgQmxvY2tjaGFpbkFwaUNvbnRyb2xsZXIgfSBmcm9tICcuLi8uLi9jb250cm9sbGVycy9CbG9ja2NoYWluQXBpQ29udHJvbGxlci5qcyc7XG5pbXBvcnQgeyBDaGFpbkNvbnRyb2xsZXIgfSBmcm9tICcuLi8uLi9jb250cm9sbGVycy9DaGFpbkNvbnRyb2xsZXIuanMnO1xuaW1wb3J0IHsgZ2V0QWN0aXZlQ2FpcE5ldHdvcmsgfSBmcm9tICcuLi8uLi91dGlscy9DaGFpbkNvbnRyb2xsZXJVdGlsLmpzJztcbmltcG9ydCB7IFJlb3duQXV0aGVudGljYXRpb25NZXNzZW5nZXIgfSBmcm9tICcuL1Jlb3duQXV0aGVudGljYXRpb25NZXNzZW5nZXIuanMnO1xuLyoqXG4gKiBUaGlzIGlzIHRoZSBjb25maWd1cmF0aW9uIGZvciB1c2luZyBTSVdYIHdpdGggUmVvd24gQXV0aGVudGljYXRpb24gc2VydmljZS5cbiAqIEl0IGFsbG93cyB5b3UgdG8gYXV0aGVudGljYXRlIGFuZCBjYXB0dXJlIHVzZXIgc2Vzc2lvbnMgdGhyb3VnaCB0aGUgQ2xvdWQgRGFzaGJvYXJkLlxuICovXG5leHBvcnQgY2xhc3MgUmVvd25BdXRoZW50aWNhdGlvbiB7XG4gICAgY29uc3RydWN0b3IocGFyYW1zID0ge30pIHtcbiAgICAgICAgdGhpcy5vdHBVdWlkID0gbnVsbDtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSB7XG4gICAgICAgICAgICBzZXNzaW9uQ2hhbmdlZDogW11cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5sb2NhbEF1dGhTdG9yYWdlS2V5ID1cbiAgICAgICAgICAgIHBhcmFtcy5sb2NhbEF1dGhTdG9yYWdlS2V5IHx8XG4gICAgICAgICAgICAgICAgU2FmZUxvY2FsU3RvcmFnZUtleXMuU0lXWF9BVVRIX1RPS0VOO1xuICAgICAgICB0aGlzLmxvY2FsTm9uY2VTdG9yYWdlS2V5ID1cbiAgICAgICAgICAgIHBhcmFtcy5sb2NhbE5vbmNlU3RvcmFnZUtleSB8fFxuICAgICAgICAgICAgICAgIFNhZmVMb2NhbFN0b3JhZ2VLZXlzLlNJV1hfTk9OQ0VfVE9LRU47XG4gICAgICAgIHRoaXMucmVxdWlyZWQgPSBwYXJhbXMucmVxdWlyZWQgPz8gdHJ1ZTtcbiAgICAgICAgdGhpcy5tZXNzZW5nZXIgPSBuZXcgUmVvd25BdXRoZW50aWNhdGlvbk1lc3Nlbmdlcih7XG4gICAgICAgICAgICBnZXROb25jZTogdGhpcy5nZXROb25jZS5iaW5kKHRoaXMpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyBjcmVhdGVNZXNzYWdlKGlucHV0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lc3Nlbmdlci5jcmVhdGVNZXNzYWdlKGlucHV0KTtcbiAgICB9XG4gICAgYXN5bmMgYWRkU2Vzc2lvbihzZXNzaW9uKSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXF1ZXN0KHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAga2V5OiAnYXV0aGVudGljYXRlJyxcbiAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICBkYXRhOiBzZXNzaW9uLmRhdGEsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogc2Vzc2lvbi5tZXNzYWdlLFxuICAgICAgICAgICAgICAgIHNpZ25hdHVyZTogc2Vzc2lvbi5zaWduYXR1cmUsXG4gICAgICAgICAgICAgICAgY2xpZW50SWQ6IHRoaXMuZ2V0Q2xpZW50SWQoKSxcbiAgICAgICAgICAgICAgICB3YWxsZXRJbmZvOiB0aGlzLmdldFdhbGxldEluZm8oKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhlYWRlcnM6IFsnbm9uY2UnLCAnb3RwJ11cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0U3RvcmFnZVRva2VuKHJlc3BvbnNlLnRva2VuLCB0aGlzLmxvY2FsQXV0aFN0b3JhZ2VLZXkpO1xuICAgICAgICB0aGlzLmVtaXQoJ3Nlc3Npb25DaGFuZ2VkJywgc2Vzc2lvbik7XG4gICAgICAgIHRoaXMuc2V0QXBwS2l0QWNjb3VudFVzZXIoand0RGVjb2RlKHJlc3BvbnNlLnRva2VuKSk7XG4gICAgICAgIHRoaXMub3RwVXVpZCA9IG51bGw7XG4gICAgfVxuICAgIGFzeW5jIGdldFNlc3Npb25zKGNoYWluSWQsIGFkZHJlc3MpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5nZXRTdG9yYWdlVG9rZW4odGhpcy5sb2NhbEF1dGhTdG9yYWdlS2V5KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAga2V5OiAnbWUnLFxuICAgICAgICAgICAgICAgIHF1ZXJ5OiB7fSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiBbJ2F1dGgnXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBpc1NhbWVBZGRyZXNzID0gYWNjb3VudC5hZGRyZXNzLnRvTG93ZXJDYXNlKCkgPT09IGFkZHJlc3MudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGNvbnN0IGlzU2FtZU5ldHdvcmsgPSBhY2NvdW50LmNhaXAyTmV0d29yayA9PT0gY2hhaW5JZDtcbiAgICAgICAgICAgIGlmICghaXNTYW1lQWRkcmVzcyB8fCAhaXNTYW1lTmV0d29yaykge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSB7XG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBhY2NvdW50QWRkcmVzczogYWNjb3VudC5hZGRyZXNzLFxuICAgICAgICAgICAgICAgICAgICBjaGFpbklkOiBhY2NvdW50LmNhaXAyTmV0d29ya1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJycsXG4gICAgICAgICAgICAgICAgc2lnbmF0dXJlOiAnJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuZW1pdCgnc2Vzc2lvbkNoYW5nZWQnLCBzZXNzaW9uKTtcbiAgICAgICAgICAgIHRoaXMuc2V0QXBwS2l0QWNjb3VudFVzZXIoYWNjb3VudCk7XG4gICAgICAgICAgICByZXR1cm4gW3Nlc3Npb25dO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyByZXZva2VTZXNzaW9uKF9jaGFpbklkLCBfYWRkcmVzcykge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuY2xlYXJTdG9yYWdlVG9rZW5zKCkpO1xuICAgIH1cbiAgICBhc3luYyBzZXRTZXNzaW9ucyhzZXNzaW9ucykge1xuICAgICAgICBpZiAoc2Vzc2lvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFyU3RvcmFnZVRva2VucygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IChzZXNzaW9ucy5maW5kKHMgPT4gcy5kYXRhLmNoYWluSWQgPT09IGdldEFjdGl2ZUNhaXBOZXR3b3JrKCk/LmNhaXBOZXR3b3JrSWQpIHx8IHNlc3Npb25zWzBdKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYWRkU2Vzc2lvbihzZXNzaW9uKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRSZXF1aXJlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVxdWlyZWQ7XG4gICAgfVxuICAgIGFzeW5jIGdldFNlc3Npb25BY2NvdW50KCkge1xuICAgICAgICBpZiAoIXRoaXMuZ2V0U3RvcmFnZVRva2VuKHRoaXMubG9jYWxBdXRoU3RvcmFnZUtleSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm90IGF1dGhlbnRpY2F0ZWQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHtcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICBrZXk6ICdtZScsXG4gICAgICAgICAgICBib2R5OiB1bmRlZmluZWQsXG4gICAgICAgICAgICBxdWVyeToge1xuICAgICAgICAgICAgICAgIGluY2x1ZGVBcHBLaXRBY2NvdW50OiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGVhZGVyczogWydhdXRoJ11cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFzeW5jIHNldFNlc3Npb25BY2NvdW50TWV0YWRhdGEobWV0YWRhdGEgPSBudWxsKSB7XG4gICAgICAgIGlmICghdGhpcy5nZXRTdG9yYWdlVG9rZW4odGhpcy5sb2NhbEF1dGhTdG9yYWdlS2V5KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOb3QgYXV0aGVudGljYXRlZCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgICAgIGtleTogJ2FjY291bnQtbWV0YWRhdGEnLFxuICAgICAgICAgICAgYm9keTogeyBtZXRhZGF0YSB9LFxuICAgICAgICAgICAgaGVhZGVyczogWydhdXRoJ11cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG9uKGV2ZW50LCBjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmxpc3RlbmVyc1tldmVudF0ucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1tldmVudF0gPSB0aGlzLmxpc3RlbmVyc1tldmVudF0uZmlsdGVyKGNiID0+IGNiICE9PSBjYWxsYmFjayk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJlbW92ZUFsbExpc3RlbmVycygpIHtcbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMubGlzdGVuZXJzKTtcbiAgICAgICAga2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1trZXldID0gW107XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyByZXF1ZXN0RW1haWxPdHAoeyBlbWFpbCwgYWNjb3VudCB9KSB7XG4gICAgICAgIGNvbnN0IG90cCA9IGF3YWl0IHRoaXMucmVxdWVzdCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGtleTogJ290cCcsXG4gICAgICAgICAgICBib2R5OiB7IGVtYWlsLCBhY2NvdW50IH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMub3RwVXVpZCA9IG90cC51dWlkO1xuICAgICAgICB0aGlzLm1lc3Nlbmdlci5yZXNvdXJjZXMgPSBbYGVtYWlsOiR7ZW1haWx9YF07XG4gICAgICAgIHJldHVybiBvdHA7XG4gICAgfVxuICAgIGNvbmZpcm1FbWFpbE90cCh7IGNvZGUgfSkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICBrZXk6ICdvdHAnLFxuICAgICAgICAgICAgYm9keTogeyBjb2RlIH0sXG4gICAgICAgICAgICBoZWFkZXJzOiBbJ290cCddXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyByZXF1ZXN0KHsgbWV0aG9kLCBrZXksIHF1ZXJ5LCBib2R5LCBoZWFkZXJzIH0pIHtcbiAgICAgICAgY29uc3QgeyBwcm9qZWN0SWQsIHN0LCBzdiB9ID0gdGhpcy5nZXRTREtQcm9wZXJ0aWVzKCk7XG4gICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7Q29uc3RhbnRzVXRpbC5XM01fQVBJX1VSTH0vYXV0aC92MS8ke1N0cmluZyhrZXkpfWApO1xuICAgICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgncHJvamVjdElkJywgcHJvamVjdElkKTtcbiAgICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ3N0Jywgc3QpO1xuICAgICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgnc3YnLCBzdik7XG4gICAgICAgIGlmIChxdWVyeSkge1xuICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMocXVlcnkpLmZvckVhY2goKFtxdWVyeUtleSwgcXVlcnlWYWx1ZV0pID0+IHVybC5zZWFyY2hQYXJhbXMuc2V0KHF1ZXJ5S2V5LCBTdHJpbmcocXVlcnlWYWx1ZSkpKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICAgICAgbWV0aG9kLFxuICAgICAgICAgICAgYm9keTogYm9keSA/IEpTT04uc3RyaW5naWZ5KGJvZHkpIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgaGVhZGVyczogQXJyYXkuaXNBcnJheShoZWFkZXJzKVxuICAgICAgICAgICAgICAgID8gaGVhZGVycy5yZWR1Y2UoKGFjYywgaGVhZGVyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoaGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdub25jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjWyd4LW5vbmNlLWp3dCddID0gYEJlYXJlciAke3RoaXMuZ2V0U3RvcmFnZVRva2VuKHRoaXMubG9jYWxOb25jZVN0b3JhZ2VLZXkpfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhdXRoJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NbJ0F1dGhvcml6YXRpb24nXSA9IGBCZWFyZXIgJHt0aGlzLmdldFN0b3JhZ2VUb2tlbih0aGlzLmxvY2FsQXV0aFN0b3JhZ2VLZXkpfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdvdHAnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm90cFV1aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjWyd4LW90cCddID0gdGhpcy5vdHBVdWlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICAgICAgICB9LCB7fSlcbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGF3YWl0IHJlc3BvbnNlLnRleHQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdjb250ZW50LXR5cGUnKT8uaW5jbHVkZXMoJ2FwcGxpY2F0aW9uL2pzb24nKSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgZ2V0U3RvcmFnZVRva2VuKGtleSkge1xuICAgICAgICByZXR1cm4gU2FmZUxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XG4gICAgfVxuICAgIHNldFN0b3JhZ2VUb2tlbih0b2tlbiwga2V5KSB7XG4gICAgICAgIFNhZmVMb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHRva2VuKTtcbiAgICB9XG4gICAgY2xlYXJTdG9yYWdlVG9rZW5zKCkge1xuICAgICAgICB0aGlzLm90cFV1aWQgPSBudWxsO1xuICAgICAgICBTYWZlTG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5sb2NhbEF1dGhTdG9yYWdlS2V5KTtcbiAgICAgICAgU2FmZUxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHRoaXMubG9jYWxOb25jZVN0b3JhZ2VLZXkpO1xuICAgICAgICB0aGlzLmVtaXQoJ3Nlc3Npb25DaGFuZ2VkJywgdW5kZWZpbmVkKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0Tm9uY2UoKSB7XG4gICAgICAgIGNvbnN0IHsgbm9uY2UsIHRva2VuIH0gPSBhd2FpdCB0aGlzLnJlcXVlc3Qoe1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIGtleTogJ25vbmNlJ1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRTdG9yYWdlVG9rZW4odG9rZW4sIHRoaXMubG9jYWxOb25jZVN0b3JhZ2VLZXkpO1xuICAgICAgICByZXR1cm4gbm9uY2U7XG4gICAgfVxuICAgIGdldENsaWVudElkKCkge1xuICAgICAgICByZXR1cm4gQmxvY2tjaGFpbkFwaUNvbnRyb2xsZXIuc3RhdGUuY2xpZW50SWQ7XG4gICAgfVxuICAgIGdldFdhbGxldEluZm8oKSB7XG4gICAgICAgIGNvbnN0IHdhbGxldEluZm8gPSBDaGFpbkNvbnRyb2xsZXIuZ2V0QWNjb3VudERhdGEoKT8uY29ubmVjdGVkV2FsbGV0SW5mbztcbiAgICAgICAgaWYgKCF3YWxsZXRJbmZvKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGlmICgnc29jaWFsJyBpbiB3YWxsZXRJbmZvICYmICdpZGVudGlmaWVyJyBpbiB3YWxsZXRJbmZvKSB7XG4gICAgICAgICAgICBjb25zdCBzb2NpYWwgPSB3YWxsZXRJbmZvWydzb2NpYWwnXTtcbiAgICAgICAgICAgIGNvbnN0IGlkZW50aWZpZXIgPSB3YWxsZXRJbmZvWydpZGVudGlmaWVyJ107XG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiAnc29jaWFsJywgc29jaWFsLCBpZGVudGlmaWVyIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBuYW1lLCBpY29uIH0gPSB3YWxsZXRJbmZvO1xuICAgICAgICBsZXQgdHlwZSA9ICd1bmtub3duJztcbiAgICAgICAgc3dpdGNoICh3YWxsZXRJbmZvLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ0VYVEVSTkFMJzpcbiAgICAgICAgICAgIGNhc2UgJ0lOSkVDVEVEJzpcbiAgICAgICAgICAgIGNhc2UgJ0FOTk9VTkNFRCc6XG4gICAgICAgICAgICAgICAgdHlwZSA9ICdleHRlbnNpb24nO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnV0FMTEVUX0NPTk5FQ1QnOlxuICAgICAgICAgICAgICAgIHR5cGUgPSAnd2FsbGV0Y29ubmVjdCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHR5cGUgPSAndW5rbm93bic7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgaWNvblxuICAgICAgICB9O1xuICAgIH1cbiAgICBnZXRTREtQcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gQXBpQ29udHJvbGxlci5fZ2V0U2RrUHJvcGVydGllcygpO1xuICAgIH1cbiAgICBlbWl0KGV2ZW50LCBkYXRhKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzW2V2ZW50XS5mb3JFYWNoKGxpc3RlbmVyID0+IGxpc3RlbmVyKGRhdGEpKTtcbiAgICB9XG4gICAgc2V0QXBwS2l0QWNjb3VudFVzZXIoc2Vzc2lvbikge1xuICAgICAgICBjb25zdCB7IGVtYWlsIH0gPSBzZXNzaW9uO1xuICAgICAgICBpZiAoZW1haWwpIHtcbiAgICAgICAgICAgIE9iamVjdC52YWx1ZXMoQ29uc3RhbnRzVXRpbC5DSEFJTikuZm9yRWFjaChjaGFpbk5hbWVzcGFjZSA9PiB7XG4gICAgICAgICAgICAgICAgQ2hhaW5Db250cm9sbGVyLnNldEFjY291bnRQcm9wKCd1c2VyJywgeyBlbWFpbCB9LCBjaGFpbk5hbWVzcGFjZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8qKlxuICogRGVjb2RlcyBhIEpXVCB0b2tlbiBhbmQgcmV0dXJucyBpdHMgcGF5bG9hZFxuICogQHBhcmFtIHRva2VuIC0gVGhlIEpXVCB0b2tlbiB0byBkZWNvZGVcbiAqIEByZXR1cm5zIFRoZSBkZWNvZGVkIHBheWxvYWQgb3IgbnVsbCBpZiBpbnZhbGlkXG4gKi9cbmZ1bmN0aW9uIGp3dERlY29kZSh0b2tlbikge1xuICAgIC8vIFNwbGl0IHRoZSB0b2tlbiBpbnRvIHBhcnRzXG4gICAgY29uc3QgcGFydHMgPSB0b2tlbi5zcGxpdCgnLicpO1xuICAgIC8vIENoZWNrIGlmIHRoZSB0b2tlbiBoYXMgdGhlIGNvcnJlY3QgZm9ybWF0IChoZWFkZXIucGF5bG9hZC5zaWduYXR1cmUpXG4gICAgaWYgKHBhcnRzLmxlbmd0aCAhPT0gMykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdG9rZW4nKTtcbiAgICB9XG4gICAgLy8gRGVjb2RlIHRoZSBwYXlsb2FkIChzZWNvbmQgcGFydClcbiAgICBjb25zdCBwYXlsb2FkID0gcGFydHNbMV07XG4gICAgaWYgKHR5cGVvZiBwYXlsb2FkICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdG9rZW4nKTtcbiAgICB9XG4gICAgLy8gQ29udmVydCBiYXNlNjR1cmwgdG8gYmFzZTY0XG4gICAgY29uc3QgYmFzZTY0ID0gcGF5bG9hZC5yZXBsYWNlKC8tL2d1LCAnKycpLnJlcGxhY2UoL18vZ3UsICcvJyk7XG4gICAgLy8gQWRkIHBhZGRpbmcgaWYgbmVlZGVkXG4gICAgY29uc3QgcGFkZGVkID0gYmFzZTY0LnBhZEVuZChiYXNlNjQubGVuZ3RoICsgKCg0IC0gKGJhc2U2NC5sZW5ndGggJSA0KSkgJSA0KSwgJz0nKTtcbiAgICAvLyBEZWNvZGUgYW5kIHBhcnNlIHRoZSBKU09OXG4gICAgY29uc3QgZGVjb2RlZCA9IEpTT04ucGFyc2UoYXRvYihwYWRkZWQpKTtcbiAgICByZXR1cm4gZGVjb2RlZDtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlb3duQXV0aGVudGljYXRpb24uanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/ReownAuthentication.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/ReownAuthenticationMessenger.js":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/ReownAuthenticationMessenger.js ***!
  \***************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ReownAuthenticationMessenger: () => (/* binding */ ReownAuthenticationMessenger)\n/* harmony export */ });\n/* harmony import */ var _reown_appkit_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @reown/appkit-common */ \"(app-pages-browser)/./node_modules/@reown/appkit-common/dist/esm/src/utils/NetworkUtil.js\");\n/* harmony import */ var _controllers_ChainController_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../controllers/ChainController.js */ \"(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/controllers/ChainController.js\");\n\n\nclass ReownAuthenticationMessenger {\n    constructor(params) {\n        this.getNonce = params.getNonce;\n    }\n    async createMessage(input) {\n        const params = {\n            accountAddress: input.accountAddress,\n            chainId: input.chainId,\n            version: '1',\n            domain: typeof document === 'undefined' ? 'Unknown Domain' : document.location.host,\n            uri: typeof document === 'undefined' ? 'Unknown URI' : document.location.href,\n            resources: this.resources,\n            nonce: await this.getNonce(input),\n            issuedAt: this.stringifyDate(new Date()),\n            statement: undefined,\n            expirationTime: undefined,\n            notBefore: undefined\n        };\n        const methods = {\n            toString: () => this.stringify(params)\n        };\n        return Object.assign(params, methods);\n    }\n    stringify(params) {\n        const networkName = this.getNetworkName(params.chainId);\n        return [\n            `${params.domain} wants you to sign in with your ${networkName} account:`,\n            params.accountAddress,\n            params.statement ? `\\n${params.statement}\\n` : '',\n            `URI: ${params.uri}`,\n            `Version: ${params.version}`,\n            `Chain ID: ${params.chainId}`,\n            `Nonce: ${params.nonce}`,\n            params.issuedAt && `Issued At: ${params.issuedAt}`,\n            params.expirationTime && `Expiration Time: ${params.expirationTime}`,\n            params.notBefore && `Not Before: ${params.notBefore}`,\n            params.requestId && `Request ID: ${params.requestId}`,\n            params.resources?.length &&\n                params.resources.reduce((acc, resource) => `${acc}\\n- ${resource}`, 'Resources:')\n        ]\n            .filter(line => typeof line === 'string')\n            .join('\\n')\n            .trim();\n    }\n    getNetworkName(chainId) {\n        const requestedNetworks = _controllers_ChainController_js__WEBPACK_IMPORTED_MODULE_0__.ChainController.getAllRequestedCaipNetworks();\n        return _reown_appkit_common__WEBPACK_IMPORTED_MODULE_1__.NetworkUtil.getNetworkNameByCaipNetworkId(requestedNetworks, chainId);\n    }\n    stringifyDate(date) {\n        return date.toISOString();\n    }\n}\n//# sourceMappingURL=ReownAuthenticationMessenger.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AcmVvd24vYXBwa2l0LWNvbnRyb2xsZXJzL2Rpc3QvZXNtL3NyYy9mZWF0dXJlcy9yZW93bi1hdXRoZW50aWNhdGlvbi9SZW93bkF1dGhlbnRpY2F0aW9uTWVzc2VuZ2VyLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFtRDtBQUNvQjtBQUNoRTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxlQUFlLGlDQUFpQyxhQUFhO0FBQzVFO0FBQ0Esb0NBQW9DLGlCQUFpQjtBQUNyRCxvQkFBb0IsV0FBVztBQUMvQix3QkFBd0IsZUFBZTtBQUN2Qyx5QkFBeUIsZUFBZTtBQUN4QyxzQkFBc0IsYUFBYTtBQUNuQyw2Q0FBNkMsZ0JBQWdCO0FBQzdELHlEQUF5RCxzQkFBc0I7QUFDL0UsK0NBQStDLGlCQUFpQjtBQUNoRSwrQ0FBK0MsaUJBQWlCO0FBQ2hFO0FBQ0EsOERBQThELElBQUksTUFBTSxTQUFTO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyw0RUFBZTtBQUNqRCxlQUFlLDZEQUFXO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFx0aXJ1bVxcRG93bmxvYWRzXFxEZWNlbnNhdF9kYzNcXG5vZGVfbW9kdWxlc1xcQHJlb3duXFxhcHBraXQtY29udHJvbGxlcnNcXGRpc3RcXGVzbVxcc3JjXFxmZWF0dXJlc1xccmVvd24tYXV0aGVudGljYXRpb25cXFJlb3duQXV0aGVudGljYXRpb25NZXNzZW5nZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV0d29ya1V0aWwgfSBmcm9tICdAcmVvd24vYXBwa2l0LWNvbW1vbic7XG5pbXBvcnQgeyBDaGFpbkNvbnRyb2xsZXIgfSBmcm9tICcuLi8uLi9jb250cm9sbGVycy9DaGFpbkNvbnRyb2xsZXIuanMnO1xuZXhwb3J0IGNsYXNzIFJlb3duQXV0aGVudGljYXRpb25NZXNzZW5nZXIge1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtcykge1xuICAgICAgICB0aGlzLmdldE5vbmNlID0gcGFyYW1zLmdldE5vbmNlO1xuICAgIH1cbiAgICBhc3luYyBjcmVhdGVNZXNzYWdlKGlucHV0KSB7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHtcbiAgICAgICAgICAgIGFjY291bnRBZGRyZXNzOiBpbnB1dC5hY2NvdW50QWRkcmVzcyxcbiAgICAgICAgICAgIGNoYWluSWQ6IGlucHV0LmNoYWluSWQsXG4gICAgICAgICAgICB2ZXJzaW9uOiAnMScsXG4gICAgICAgICAgICBkb21haW46IHR5cGVvZiBkb2N1bWVudCA9PT0gJ3VuZGVmaW5lZCcgPyAnVW5rbm93biBEb21haW4nIDogZG9jdW1lbnQubG9jYXRpb24uaG9zdCxcbiAgICAgICAgICAgIHVyaTogdHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJyA/ICdVbmtub3duIFVSSScgOiBkb2N1bWVudC5sb2NhdGlvbi5ocmVmLFxuICAgICAgICAgICAgcmVzb3VyY2VzOiB0aGlzLnJlc291cmNlcyxcbiAgICAgICAgICAgIG5vbmNlOiBhd2FpdCB0aGlzLmdldE5vbmNlKGlucHV0KSxcbiAgICAgICAgICAgIGlzc3VlZEF0OiB0aGlzLnN0cmluZ2lmeURhdGUobmV3IERhdGUoKSksXG4gICAgICAgICAgICBzdGF0ZW1lbnQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGV4cGlyYXRpb25UaW1lOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBub3RCZWZvcmU6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBtZXRob2RzID0ge1xuICAgICAgICAgICAgdG9TdHJpbmc6ICgpID0+IHRoaXMuc3RyaW5naWZ5KHBhcmFtcylcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24ocGFyYW1zLCBtZXRob2RzKTtcbiAgICB9XG4gICAgc3RyaW5naWZ5KHBhcmFtcykge1xuICAgICAgICBjb25zdCBuZXR3b3JrTmFtZSA9IHRoaXMuZ2V0TmV0d29ya05hbWUocGFyYW1zLmNoYWluSWQpO1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgYCR7cGFyYW1zLmRvbWFpbn0gd2FudHMgeW91IHRvIHNpZ24gaW4gd2l0aCB5b3VyICR7bmV0d29ya05hbWV9IGFjY291bnQ6YCxcbiAgICAgICAgICAgIHBhcmFtcy5hY2NvdW50QWRkcmVzcyxcbiAgICAgICAgICAgIHBhcmFtcy5zdGF0ZW1lbnQgPyBgXFxuJHtwYXJhbXMuc3RhdGVtZW50fVxcbmAgOiAnJyxcbiAgICAgICAgICAgIGBVUkk6ICR7cGFyYW1zLnVyaX1gLFxuICAgICAgICAgICAgYFZlcnNpb246ICR7cGFyYW1zLnZlcnNpb259YCxcbiAgICAgICAgICAgIGBDaGFpbiBJRDogJHtwYXJhbXMuY2hhaW5JZH1gLFxuICAgICAgICAgICAgYE5vbmNlOiAke3BhcmFtcy5ub25jZX1gLFxuICAgICAgICAgICAgcGFyYW1zLmlzc3VlZEF0ICYmIGBJc3N1ZWQgQXQ6ICR7cGFyYW1zLmlzc3VlZEF0fWAsXG4gICAgICAgICAgICBwYXJhbXMuZXhwaXJhdGlvblRpbWUgJiYgYEV4cGlyYXRpb24gVGltZTogJHtwYXJhbXMuZXhwaXJhdGlvblRpbWV9YCxcbiAgICAgICAgICAgIHBhcmFtcy5ub3RCZWZvcmUgJiYgYE5vdCBCZWZvcmU6ICR7cGFyYW1zLm5vdEJlZm9yZX1gLFxuICAgICAgICAgICAgcGFyYW1zLnJlcXVlc3RJZCAmJiBgUmVxdWVzdCBJRDogJHtwYXJhbXMucmVxdWVzdElkfWAsXG4gICAgICAgICAgICBwYXJhbXMucmVzb3VyY2VzPy5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICBwYXJhbXMucmVzb3VyY2VzLnJlZHVjZSgoYWNjLCByZXNvdXJjZSkgPT4gYCR7YWNjfVxcbi0gJHtyZXNvdXJjZX1gLCAnUmVzb3VyY2VzOicpXG4gICAgICAgIF1cbiAgICAgICAgICAgIC5maWx0ZXIobGluZSA9PiB0eXBlb2YgbGluZSA9PT0gJ3N0cmluZycpXG4gICAgICAgICAgICAuam9pbignXFxuJylcbiAgICAgICAgICAgIC50cmltKCk7XG4gICAgfVxuICAgIGdldE5ldHdvcmtOYW1lKGNoYWluSWQpIHtcbiAgICAgICAgY29uc3QgcmVxdWVzdGVkTmV0d29ya3MgPSBDaGFpbkNvbnRyb2xsZXIuZ2V0QWxsUmVxdWVzdGVkQ2FpcE5ldHdvcmtzKCk7XG4gICAgICAgIHJldHVybiBOZXR3b3JrVXRpbC5nZXROZXR3b3JrTmFtZUJ5Q2FpcE5ldHdvcmtJZChyZXF1ZXN0ZWROZXR3b3JrcywgY2hhaW5JZCk7XG4gICAgfVxuICAgIHN0cmluZ2lmeURhdGUoZGF0ZSkge1xuICAgICAgICByZXR1cm4gZGF0ZS50b0lTT1N0cmluZygpO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlb3duQXV0aGVudGljYXRpb25NZXNzZW5nZXIuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/ReownAuthenticationMessenger.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/index.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/index.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ReownAuthentication: () => (/* reexport safe */ _ReownAuthentication_js__WEBPACK_IMPORTED_MODULE_0__.ReownAuthentication),\n/* harmony export */   ReownAuthenticationMessenger: () => (/* reexport safe */ _ReownAuthenticationMessenger_js__WEBPACK_IMPORTED_MODULE_1__.ReownAuthenticationMessenger)\n/* harmony export */ });\n/* harmony import */ var _ReownAuthentication_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ReownAuthentication.js */ \"(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/ReownAuthentication.js\");\n/* harmony import */ var _ReownAuthenticationMessenger_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ReownAuthenticationMessenger.js */ \"(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/ReownAuthenticationMessenger.js\");\n\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AcmVvd24vYXBwa2l0LWNvbnRyb2xsZXJzL2Rpc3QvZXNtL3NyYy9mZWF0dXJlcy9yZW93bi1hdXRoZW50aWNhdGlvbi9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXlDO0FBQ1M7QUFDbEQiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcdGlydW1cXERvd25sb2Fkc1xcRGVjZW5zYXRfZGMzXFxub2RlX21vZHVsZXNcXEByZW93blxcYXBwa2l0LWNvbnRyb2xsZXJzXFxkaXN0XFxlc21cXHNyY1xcZmVhdHVyZXNcXHJlb3duLWF1dGhlbnRpY2F0aW9uXFxpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgKiBmcm9tICcuL1Jlb3duQXV0aGVudGljYXRpb24uanMnO1xuZXhwb3J0ICogZnJvbSAnLi9SZW93bkF1dGhlbnRpY2F0aW9uTWVzc2VuZ2VyLmpzJztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@reown/appkit-controllers/dist/esm/src/features/reown-authentication/index.js\n"));

/***/ })

}]);